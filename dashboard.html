<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Benchmark Results Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            color: white;
        }

        .header h1 {
            font-size: 3rem;
            font-weight: 700;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            text-align: center;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: 700;
            color: #667eea;
            margin-bottom: 10px;
        }

        .stat-label {
            font-size: 1rem;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .charts-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }

        .chart-container {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .chart-title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 20px;
            color: #333;
            text-align: center;
        }

        .full-width {
            grid-column: 1 / -1;
        }

        .results-table {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        th {
            background: #f8f9fa;
            font-weight: 600;
            color: #333;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-size: 0.9rem;
            cursor: pointer;
            user-select: none;
            position: relative;
            transition: background-color 0.2s ease;
        }

        th:hover {
            background: #e9ecef;
        }

        th.sortable::after {
            content: ' ‚ÜïÔ∏è';
            font-size: 0.8rem;
            opacity: 0.5;
        }

        th.sort-asc::after {
            content: ' ‚Üë';
            opacity: 1;
            color: #667eea;
        }

        th.sort-desc::after {
            content: ' ‚Üì';
            opacity: 1;
            color: #667eea;
        }

        tr:hover {
            background: #f8f9fa;
        }

        .status-success {
            color: #28a745;
            font-weight: 600;
        }

        .status-failed {
            color: #dc3545;
            font-weight: 600;
        }

        .rps-value {
            font-weight: 600;
            color: #667eea;
        }

        .implementation-tag {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 500;
            margin-right: 5px;
        }

        .rust { background: #deb887; color: #8b4513; }
        .go { background: #add8e6; color: #4682b4; }
        .python { background: #ffd700; color: #b8860b; }
        .javascript { background: #98fb98; color: #228b22; }

        .filters {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .filter-group label {
            font-weight: 600;
            color: white;
            font-size: 0.9rem;
        }

        select {
            padding: 8px 12px;
            border: none;
            border-radius: 8px;
            background: white;
            font-size: 0.9rem;
            cursor: pointer;
        }

        .legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            color: white;
        }

        .legend-color {
            width: 16px;
            height: 16px;
            border-radius: 4px;
        }

        @media (max-width: 768px) {
            .charts-grid {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .filters {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üöÄ API Benchmark Dashboard</h1>
            <p>Performance comparison across different implementations and scenarios</p>
        </div>

        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-number" id="totalTests">-</div>
                <div class="stat-label">Total Tests</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="successfulTests">-</div>
                <div class="stat-label">Successful</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="failedTests">-</div>
                <div class="stat-label">Failed</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="topRPS">-</div>
                <div class="stat-label">Highest RPS</div>
            </div>
        </div>

        <div class="filters">
            <div class="filter-group">
                <label for="scenarioFilter">Scenario:</label>
                <select id="scenarioFilter">
                    <option value="all">All Scenarios</option>
                    <option value="mixed_light">Light Load</option>
                    <option value="mixed_medium">Medium Load</option>
                    <option value="mixed_heavy">Heavy Load</option>
                    <option value="mixed_extreme">Extreme Load</option>
                </select>
            </div>
            <div class="filter-group">
                <label for="implementationFilter">Implementation:</label>
                <select id="implementationFilter">
                    <option value="all">All Implementations</option>
                </select>
            </div>
        </div>

        <div class="charts-grid">
            <div class="chart-container">
                <div class="chart-title">Performance by Implementation</div>
                <canvas id="performanceChart"></canvas>
            </div>
            <div class="chart-container">
                <div class="chart-title">Success Rate by Scenario</div>
                <canvas id="successChart"></canvas>
            </div>
            <div class="chart-container full-width">
                <div class="chart-title">RPS Comparison Across All Scenarios</div>
                <canvas id="comparisonChart"></canvas>
            </div>
            <div class="chart-container">
                <div class="chart-title">Min Response Times by Scenario</div>
                <canvas id="minRTChart"></canvas>
            </div>
            <div class="chart-container">
                <div class="chart-title">Median Response Times by Scenario</div>
                <canvas id="medRTChart"></canvas>
            </div>
            <div class="chart-container">
                <div class="chart-title">Average Response Times by Scenario</div>
                <canvas id="avgRTChart"></canvas>
            </div>
            <div class="chart-container">
                <div class="chart-title">Max Response Times by Scenario</div>
                <canvas id="maxRTChart"></canvas>
            </div>
            <div class="chart-container">
                <div class="chart-title">P95 Response Times by Scenario</div>
                <canvas id="p95Chart"></canvas>
            </div>
            <div class="chart-container">
                <div class="chart-title">P99 Response Times by Scenario</div>
                <canvas id="p99Chart"></canvas>
            </div>
        </div>

        <div class="results-table">
            <div class="chart-title">Detailed Results</div>
            <table id="resultsTable">
                <thead>
                    <tr>
                        <th class="sortable" data-column="implementation">Implementation</th>
                        <th class="sortable" data-column="test">Scenario</th>
                        <th class="sortable" data-column="vus">VUs</th>
                        <th class="sortable" data-column="duration">Duration</th>
                        <th class="sortable" data-column="rps">RPS</th>
                        <th class="sortable" data-column="avgRT">Avg RT (ms)</th>
                        <th class="sortable" data-column="p95RT">P95 RT (ms)</th>
                        <th class="sortable" data-column="p99RT">P99 RT (ms)</th>
                        <th class="sortable" data-column="status">Status</th>
                    </tr>
                </thead>
                <tbody id="resultsBody">
                </tbody>
            </table>
        </div>
    </div>

    <script>
        // Benchmark data with detailed metrics
        const benchmarkData = [
  {
    "implementation": "go-fiber",
    "test": "mixed_extreme",
    "vus": 1000,
    "duration": "10s",
    "rps": 8977.292321752959,
    "status": "success",
    "responseTime": {
      "min": 0.2,
      "med": 81.602,
      "avg": 103.9992357520191,
      "max": 524.246,
      "p95": 207.3114,
      "p99": 311.59439999999995
    },
    "totalRequests": 96733,
    "checks": {
      "passes": 95632,
      "fails": 0,
      "rate": 1
    }
  },
  {
    "implementation": "go-fiber",
    "test": "mixed_heavy",
    "vus": 500,
    "duration": "10s",
    "rps": 10784.361328369147,
    "status": "success",
    "responseTime": {
      "min": 0.2,
      "med": 31.872,
      "avg": 43.69455057520308,
      "max": 140.653,
      "p95": 85.49479999999998,
      "p99": 101.01016
    },
    "totalRequests": 114829,
    "checks": {
      "passes": 113728,
      "fails": 0,
      "rate": 1
    }
  },
  {
    "implementation": "go-fiber",
    "test": "mixed_light",
    "vus": 50,
    "duration": "10s",
    "rps": 10414.69608252959,
    "status": "success",
    "responseTime": {
      "min": 0.207,
      "med": 3.52,
      "avg": 4.543264664682974,
      "max": 49.521,
      "p95": 9.065799999999996,
      "p99": 12.667519999999998
    },
    "totalRequests": 109225,
    "checks": {
      "passes": 108124,
      "fails": 0,
      "rate": 1
    }
  },
  {
    "implementation": "go-fiber",
    "test": "mixed_medium",
    "vus": 200,
    "duration": "10s",
    "rps": 10100.127711050938,
    "status": "success",
    "responseTime": {
      "min": 0.268,
      "med": 13.969,
      "avg": 18.536700536742266,
      "max": 98.387,
      "p95": 36.237399999999994,
      "p99": 47.891759999999984
    },
    "totalRequests": 107873,
    "checks": {
      "passes": 106772,
      "fails": 0,
      "rate": 1
    }
  },
  {
    "implementation": "js-bun-express+bunpg",
    "test": "mixed_extreme",
    "vus": 1000,
    "duration": "10s",
    "rps": 7279.92588728712,
    "status": "success",
    "responseTime": {
      "min": 0.502,
      "med": 94.52,
      "avg": 121.75401896644875,
      "max": 521.304,
      "p95": 244.61259999999996,
      "p99": 287.67536
    },
    "totalRequests": 83305,
    "checks": {
      "passes": 82204,
      "fails": 0,
      "rate": 1
    }
  },
  {
    "implementation": "js-bun-express+bunpg",
    "test": "mixed_heavy",
    "vus": 500,
    "duration": "10s",
    "rps": 8334.95,
    "status": "success",
    "responseTime": {
      "min": 0.486,
      "med": 46.191,
      "avg": 58.89174937067593,
      "max": 180.414,
      "p95": 114.29,
      "p99": 141.96771999999996
    },
    "totalRequests": 85409,
    "checks": {
      "passes": 84308,
      "fails": 0,
      "rate": 1
    }
  },
  {
    "implementation": "js-bun-express+bunpg",
    "test": "mixed_light",
    "vus": 50,
    "duration": "10s",
    "rps": 7786.53,
    "status": "success",
    "responseTime": {
      "min": 0.493,
      "med": 4.945,
      "avg": 6.296908687573475,
      "max": 71.204,
      "p95": 14.574399999999995,
      "p99": 19.886679999999995
    },
    "totalRequests": 79113,
    "checks": {
      "passes": 78012,
      "fails": 0,
      "rate": 1
    }
  },
  {
    "implementation": "js-bun-express+bunpg",
    "test": "mixed_medium",
    "vus": 200,
    "duration": "10s",
    "rps": 7959.78,
    "status": "success",
    "responseTime": {
      "min": 0.429,
      "med": 19.306,
      "avg": 24.696669011914874,
      "max": 84.956,
      "p95": 49.66439999999999,
      "p99": 62.62944
    },
    "totalRequests": 81157,
    "checks": {
      "passes": 80056,
      "fails": 0,
      "rate": 1
    }
  },
  {
    "implementation": "js-bun-express",
    "test": "mixed_extreme",
    "vus": 1000,
    "duration": "10s",
    "rps": 10832.99,
    "status": "success",
    "responseTime": {
      "min": 0.358,
      "med": 70.356,
      "avg": 90.55021996319648,
      "max": 273.264,
      "p95": 173.4748,
      "p99": 202.91179999999997
    },
    "totalRequests": 111405,
    "checks": {
      "passes": 110304,
      "fails": 0,
      "rate": 1
    }
  },
  {
    "implementation": "js-bun-express",
    "test": "mixed_heavy",
    "vus": 500,
    "duration": "10s",
    "rps": 9256.7,
    "status": "success",
    "responseTime": {
      "min": 0.387,
      "med": 42.816,
      "avg": 52.980324519662425,
      "max": 413.771,
      "p95": 99.46439999999998,
      "p99": 132.14695999999998
    },
    "totalRequests": 94777,
    "checks": {
      "passes": 93676,
      "fails": 0,
      "rate": 1
    }
  },
  {
    "implementation": "js-bun-express",
    "test": "mixed_light",
    "vus": 50,
    "duration": "10s",
    "rps": 11663.57,
    "status": "success",
    "responseTime": {
      "min": 0.303,
      "med": 3.252,
      "avg": 4.213436766390887,
      "max": 64.076,
      "p95": 9.773799999999994,
      "p99": 15.656759999999998
    },
    "totalRequests": 117825,
    "checks": {
      "passes": 116724,
      "fails": 0,
      "rate": 1
    }
  },
  {
    "implementation": "js-bun-express",
    "test": "mixed_medium",
    "vus": 200,
    "duration": "10s",
    "rps": 11392.5,
    "status": "success",
    "responseTime": {
      "min": 0.386,
      "med": 15.197,
      "avg": 17.32811258174872,
      "max": 85.023,
      "p95": 32.365,
      "p99": 43.59968
    },
    "totalRequests": 115445,
    "checks": {
      "passes": 114344,
      "fails": 0,
      "rate": 1
    }
  },
  {
    "implementation": "js-bun-native",
    "test": "mixed_extreme",
    "vus": 1000,
    "duration": "10s",
    "rps": null,
    "status": "failed",
    "responseTime": null,
    "totalRequests": 0,
    "checks": {
      "passes": 0,
      "fails": 0,
      "rate": 0
    }
  },
  {
    "implementation": "js-bun-native",
    "test": "mixed_heavy",
    "vus": 500,
    "duration": "10s",
    "rps": 7614,
    "status": "success",
    "responseTime": {
      "min": 0.467,
      "med": 51.147,
      "avg": 64.20215016174659,
      "max": 249.155,
      "p95": 135.3542,
      "p99": 164.33836
    },
    "totalRequests": 78209,
    "checks": {
      "passes": 77108,
      "fails": 0,
      "rate": 1
    }
  },
  {
    "implementation": "js-bun-native",
    "test": "mixed_light",
    "vus": 50,
    "duration": "10s",
    "rps": 8824.21,
    "status": "success",
    "responseTime": {
      "min": 0.357,
      "med": 4.273,
      "avg": 5.556066220728322,
      "max": 72.386,
      "p95": 13.071199999999992,
      "p99": 18.158079999999995
    },
    "totalRequests": 89549,
    "checks": {
      "passes": 88448,
      "fails": 0,
      "rate": 1
    }
  },
  {
    "implementation": "js-bun-native",
    "test": "mixed_medium",
    "vus": 200,
    "duration": "10s",
    "rps": null,
    "status": "failed",
    "responseTime": null,
    "totalRequests": 0,
    "checks": {
      "passes": 0,
      "fails": 0,
      "rate": 0
    }
  },
  {
    "implementation": "js-node-express",
    "test": "mixed_extreme",
    "vus": 1000,
    "duration": "10s",
    "rps": 4399.12,
    "status": "success",
    "responseTime": {
      "min": 0.739,
      "med": 160.153,
      "avg": 195.1706870700136,
      "max": 2029.027,
      "p95": 355.924,
      "p99": 492.69908
    },
    "totalRequests": 45205,
    "checks": {
      "passes": 44104,
      "fails": 0,
      "rate": 1
    }
  },
  {
    "implementation": "js-node-express",
    "test": "mixed_heavy",
    "vus": 500,
    "duration": "10s",
    "rps": null,
    "status": "failed",
    "responseTime": null,
    "totalRequests": 0,
    "checks": {
      "passes": 0,
      "fails": 0,
      "rate": 0
    }
  },
  {
    "implementation": "js-node-express",
    "test": "mixed_light",
    "vus": 50,
    "duration": "10s",
    "rps": 4399.12,
    "status": "success",
    "responseTime": {
      "min": 0.655,
      "med": 10.383,
      "avg": 11.067462982181125,
      "max": 191.233,
      "p95": 17.753199999999996,
      "p99": 22.031599999999997
    },
    "totalRequests": 45289,
    "checks": {
      "passes": 44188,
      "fails": 0,
      "rate": 1
    }
  },
  {
    "implementation": "js-node-express",
    "test": "mixed_medium",
    "vus": 200,
    "duration": "10s",
    "rps": 4133.65,
    "status": "success",
    "responseTime": {
      "min": 0.651,
      "med": 43.091,
      "avg": 46.767147739724116,
      "max": 1530.792,
      "p95": 72.3318,
      "p99": 79.68115999999999
    },
    "totalRequests": 42893,
    "checks": {
      "passes": 41792,
      "fails": 0,
      "rate": 1
    }
  },
  {
    "implementation": "python-fastapi-granian",
    "test": "mixed_extreme",
    "vus": 1000,
    "duration": "10s",
    "rps": null,
    "status": "failed",
    "responseTime": null,
    "totalRequests": 0,
    "checks": {
      "passes": 0,
      "fails": 0,
      "rate": 0
    }
  },
  {
    "implementation": "python-fastapi-granian",
    "test": "mixed_heavy",
    "vus": 500,
    "duration": "10s",
    "rps": null,
    "status": "failed",
    "responseTime": null,
    "totalRequests": 0,
    "checks": {
      "passes": 0,
      "fails": 0,
      "rate": 0
    }
  },
  {
    "implementation": "python-fastapi-granian",
    "test": "mixed_light",
    "vus": 50,
    "duration": "10s",
    "rps": 6942.68,
    "status": "success",
    "responseTime": {
      "min": 0.547,
      "med": 2.772,
      "avg": 7.0154493435593,
      "max": 259.687,
      "p95": 18.048999999999968,
      "p99": 129.37024
    },
    "totalRequests": 70697,
    "checks": {
      "passes": 69596,
      "fails": 0,
      "rate": 1
    }
  },
  {
    "implementation": "python-fastapi-granian",
    "test": "mixed_medium",
    "vus": 200,
    "duration": "10s",
    "rps": 6867.93,
    "status": "success",
    "responseTime": {
      "min": 0.547,
      "med": 9.962,
      "avg": 28.476422951659277,
      "max": 900.965,
      "p95": 148.0744,
      "p99": 221.24947999999998
    },
    "totalRequests": 70313,
    "checks": {
      "passes": 69212,
      "fails": 0,
      "rate": 1
    }
  },
  {
    "implementation": "python-fastapi-uvicorn",
    "test": "mixed_extreme",
    "vus": 1000,
    "duration": "10s",
    "rps": null,
    "status": "failed",
    "responseTime": null,
    "totalRequests": 0,
    "checks": {
      "passes": 0,
      "fails": 0,
      "rate": 0
    }
  },
  {
    "implementation": "python-fastapi-uvicorn",
    "test": "mixed_heavy",
    "vus": 500,
    "duration": "10s",
    "rps": null,
    "status": "failed",
    "responseTime": null,
    "totalRequests": 0,
    "checks": {
      "passes": 0,
      "fails": 0,
      "rate": 0
    }
  },
  {
    "implementation": "python-fastapi-uvicorn",
    "test": "mixed_light",
    "vus": 50,
    "duration": "10s",
    "rps": 6948.21,
    "status": "success",
    "responseTime": {
      "min": 0.362,
      "med": 2.886,
      "avg": 7.030230391671488,
      "max": 259.687,
      "p95": 18.048999999999968,
      "p99": 129.37024
    },
    "totalRequests": 70697,
    "checks": {
      "passes": 69596,
      "fails": 0,
      "rate": 1
    }
  },
  {
    "implementation": "python-fastapi-uvicorn",
    "test": "mixed_medium",
    "vus": 200,
    "duration": "10s",
    "rps": 7204.2,
    "status": "success",
    "responseTime": {
      "min": 0.083,
      "med": 7.944,
      "avg": 27.129327490287753,
      "max": 547.058,
      "p95": 151.68279999999993,
      "p99": 223.48259999999993
    },
    "totalRequests": 73877,
    "checks": {
      "passes": 72776,
      "fails": 0,
      "rate": 1
    }
  },
  {
    "implementation": "rust-axum",
    "test": "mixed_extreme",
    "vus": 1000,
    "duration": "10s",
    "rps": 10971.31,
    "status": "success",
    "responseTime": {
      "min": 0.188,
      "med": 69.533,
      "avg": 89.59782302899648,
      "max": 233.699,
      "p95": 173.2256,
      "p99": 200.47871999999998
    },
    "totalRequests": 112827,
    "checks": {
      "passes": 111726,
      "fails": 0,
      "rate": 1
    }
  },
  {
    "implementation": "rust-axum",
    "test": "mixed_heavy",
    "vus": 500,
    "duration": "10s",
    "rps": 11740.98,
    "status": "success",
    "responseTime": {
      "min": 0.188,
      "med": 31.006,
      "avg": 41.74449029126214,
      "max": 113.243,
      "p95": 81.40239999999999,
      "p99": 95.17695999999999
    },
    "totalRequests": 120509,
    "checks": {
      "passes": 119408,
      "fails": 0,
      "rate": 1
    }
  },
  {
    "implementation": "rust-axum",
    "test": "mixed_light",
    "vus": 50,
    "duration": "10s",
    "rps": 11511.99,
    "status": "success",
    "responseTime": {
      "min": 0.194,
      "med": 3.228,
      "avg": 4.277180953858617,
      "max": 23.325,
      "p95": 8.51,
      "p99": 10.469
    },
    "totalRequests": 116013,
    "checks": {
      "passes": 115312,
      "fails": 0,
      "rate": 1
    }
  },
  {
    "implementation": "rust-axum",
    "test": "mixed_medium",
    "vus": 200,
    "duration": "10s",
    "rps": 11932.65,
    "status": "success",
    "responseTime": {
      "min": 0.188,
      "med": 12.714,
      "avg": 16.47206896551724,
      "max": 62.567,
      "p95": 32.365,
      "p99": 42.816
    },
    "totalRequests": 121427,
    "checks": {
      "passes": 120326,
      "fails": 0,
      "rate": 1
    }
  }
];

        // Color schemes
        const implementationColors = {
            'rust-axum': '#ff6b6b',
            'go-fiber': '#4ecdc4',
            'python-fastapi-granian': '#45b7d1',
            'python-fastapi-uvicorn': '#96ceb4',
            'js-bun-native': '#feca57',
            'js-bun-express+bunpg': '#ff9ff3',
            'js-bun-express': '#54a0ff',
            'js-node-express': '#5f27cd'
        };

        let charts = {};
        let filteredData = benchmarkData;
        let currentSort = { column: null, direction: 'asc' };

        // Initialize dashboard
        function initDashboard() {
            updateStats();
            populateFilters();
            createCharts();
            populateTable();
            setupEventListeners();
        }

        function updateStats() {
            const totalTests = filteredData.length;
            const successfulTests = filteredData.filter(d => d.status === 'success').length;
            const failedTests = totalTests - successfulTests;
            const topRPS = Math.max(...filteredData.filter(d => d.rps).map(d => d.rps));

            document.getElementById('totalTests').textContent = totalTests;
            document.getElementById('successfulTests').textContent = successfulTests;
            document.getElementById('failedTests').textContent = failedTests;
            document.getElementById('topRPS').textContent = topRPS ? Math.round(topRPS).toLocaleString() : '-';
        }

        function populateFilters() {
            const implementations = [...new Set(benchmarkData.map(d => d.implementation))];
            const implementationSelect = document.getElementById('implementationFilter');
            
            implementations.forEach(impl => {
                const option = document.createElement('option');
                option.value = impl;
                option.textContent = impl;
                implementationSelect.appendChild(option);
            });
        }

        function createCharts() {
            createPerformanceChart();
            createSuccessChart();
            createComparisonChart();
            createMinRTChart();
            createMedRTChart();
            createAvgRTChart();
            createMaxRTChart();
            createP95Chart();
            createP99Chart();
        }

        function createPerformanceChart() {
            const ctx = document.getElementById('performanceChart').getContext('2d');
            
            const avgRPSByImpl = {};
            const implementations = [...new Set(filteredData.map(d => d.implementation))];
            
            implementations.forEach(impl => {
                const implData = filteredData.filter(d => d.implementation === impl && d.rps);
                avgRPSByImpl[impl] = implData.length > 0 ? 
                    implData.reduce((sum, d) => sum + d.rps, 0) / implData.length : 0;
            });

            if (charts.performance) charts.performance.destroy();
            
            charts.performance = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: implementations,
                    datasets: [{
                        label: 'Average RPS',
                        data: implementations.map(impl => avgRPSByImpl[impl]),
                        backgroundColor: implementations.map(impl => implementationColors[impl]),
                        borderRadius: 8,
                        borderSkipped: false,
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Requests per Second'
                            }
                        },
                        x: {
                            ticks: {
                                maxRotation: 45
                            }
                        }
                    }
                }
            });
        }

        function createSuccessChart() {
            const ctx = document.getElementById('successChart').getContext('2d');
            
            const scenarios = ['mixed_light', 'mixed_medium', 'mixed_heavy', 'mixed_extreme'];
            const successRates = scenarios.map(scenario => {
                const scenarioData = filteredData.filter(d => d.test === scenario);
                const successCount = scenarioData.filter(d => d.status === 'success').length;
                return scenarioData.length > 0 ? (successCount / scenarioData.length) * 100 : 0;
            });

            if (charts.success) charts.success.destroy();
            
            charts.success = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: scenarios.map(s => s.replace('mixed_', '').toUpperCase()),
                    datasets: [{
                        label: 'Success Rate (%)',
                        data: successRates,
                        backgroundColor: ['#28a745', '#ffc107', '#fd7e14', '#dc3545'],
                        borderRadius: 8,
                        borderSkipped: false,
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            title: {
                                display: true,
                                text: 'Success Rate (%)'
                            },
                            ticks: {
                                callback: function(value) {
                                    return value + '%';
                                }
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Load Scenario'
                            }
                        }
                    }
                }
            });
        }

        function createComparisonChart() {
            const ctx = document.getElementById('comparisonChart').getContext('2d');
            
            const scenarios = ['mixed_light', 'mixed_medium', 'mixed_heavy', 'mixed_extreme'];
            const implementations = [...new Set(filteredData.map(d => d.implementation))];
            
            const datasets = implementations.map(impl => ({
                label: impl,
                data: scenarios.map(scenario => {
                    const entry = filteredData.find(d => d.implementation === impl && d.test === scenario);
                    return entry && entry.rps ? entry.rps : null;
                }),
                borderColor: implementationColors[impl],
                backgroundColor: implementationColors[impl] + '20',
                fill: false,
                tension: 0.1,
                spanGaps: false
            }));

            if (charts.comparison) charts.comparison.destroy();
            
            charts.comparison = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: scenarios.map(s => s.replace('mixed_', '').toUpperCase()),
                    datasets: datasets
                },
                options: {
                    responsive: true,
                    interaction: {
                        mode: 'index',
                        intersect: false,
                    },
                    plugins: {
                        legend: {
                            position: 'top',
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Requests per Second'
                            }
                        }
                    }
                }
            });
        }

        function createMinRTChart() {
            const ctx = document.getElementById('minRTChart').getContext('2d');
            
            const scenarios = ['mixed_light', 'mixed_medium', 'mixed_heavy', 'mixed_extreme'];
            const implementations = [...new Set(filteredData.map(d => d.implementation))];
            
            const datasets = implementations.map(impl => ({
                label: impl,
                data: scenarios.map(scenario => {
                    const entry = filteredData.find(d => d.implementation === impl && d.test === scenario);
                    return entry && entry.responseTime ? entry.responseTime.min : null;
                }),
                borderColor: implementationColors[impl],
                backgroundColor: implementationColors[impl] + '20',
                fill: false,
                tension: 0.1,
                spanGaps: false
            }));

            if (charts.minRT) charts.minRT.destroy();
            
            charts.minRT = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: scenarios.map(s => s.replace('mixed_', '').toUpperCase()),
                    datasets: datasets
                },
                options: {
                    responsive: true,
                    interaction: {
                        mode: 'index',
                        intersect: false,
                    },
                    plugins: {
                        legend: {
                            position: 'top',
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Min Response Time (ms)'
                            }
                        }
                    }
                }
            });
        }

        function createMedRTChart() {
            const ctx = document.getElementById('medRTChart').getContext('2d');
            
            const scenarios = ['mixed_light', 'mixed_medium', 'mixed_heavy', 'mixed_extreme'];
            const implementations = [...new Set(filteredData.map(d => d.implementation))];
            
            const datasets = implementations.map(impl => ({
                label: impl,
                data: scenarios.map(scenario => {
                    const entry = filteredData.find(d => d.implementation === impl && d.test === scenario);
                    return entry && entry.responseTime ? entry.responseTime.med : null;
                }),
                borderColor: implementationColors[impl],
                backgroundColor: implementationColors[impl] + '20',
                fill: false,
                tension: 0.1,
                spanGaps: false
            }));

            if (charts.medRT) charts.medRT.destroy();
            
            charts.medRT = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: scenarios.map(s => s.replace('mixed_', '').toUpperCase()),
                    datasets: datasets
                },
                options: {
                    responsive: true,
                    interaction: {
                        mode: 'index',
                        intersect: false,
                    },
                    plugins: {
                        legend: {
                            position: 'top',
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Median Response Time (ms)'
                            }
                        }
                    }
                }
            });
        }

        function createAvgRTChart() {
            const ctx = document.getElementById('avgRTChart').getContext('2d');
            
            const scenarios = ['mixed_light', 'mixed_medium', 'mixed_heavy', 'mixed_extreme'];
            const implementations = [...new Set(filteredData.map(d => d.implementation))];
            
            const datasets = implementations.map(impl => ({
                label: impl,
                data: scenarios.map(scenario => {
                    const entry = filteredData.find(d => d.implementation === impl && d.test === scenario);
                    return entry && entry.responseTime ? entry.responseTime.avg : null;
                }),
                borderColor: implementationColors[impl],
                backgroundColor: implementationColors[impl] + '20',
                fill: false,
                tension: 0.1,
                spanGaps: false
            }));

            if (charts.avgRT) charts.avgRT.destroy();
            
            charts.avgRT = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: scenarios.map(s => s.replace('mixed_', '').toUpperCase()),
                    datasets: datasets
                },
                options: {
                    responsive: true,
                    interaction: {
                        mode: 'index',
                        intersect: false,
                    },
                    plugins: {
                        legend: {
                            position: 'top',
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Average Response Time (ms)'
                            }
                        }
                    }
                }
            });
        }

        function createMaxRTChart() {
            const ctx = document.getElementById('maxRTChart').getContext('2d');
            
            const scenarios = ['mixed_light', 'mixed_medium', 'mixed_heavy', 'mixed_extreme'];
            const implementations = [...new Set(filteredData.map(d => d.implementation))];
            
            const datasets = implementations.map(impl => ({
                label: impl,
                data: scenarios.map(scenario => {
                    const entry = filteredData.find(d => d.implementation === impl && d.test === scenario);
                    return entry && entry.responseTime ? entry.responseTime.max : null;
                }),
                borderColor: implementationColors[impl],
                backgroundColor: implementationColors[impl] + '20',
                fill: false,
                tension: 0.1,
                spanGaps: false
            }));

            if (charts.maxRT) charts.maxRT.destroy();
            
            charts.maxRT = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: scenarios.map(s => s.replace('mixed_', '').toUpperCase()),
                    datasets: datasets
                },
                options: {
                    responsive: true,
                    interaction: {
                        mode: 'index',
                        intersect: false,
                    },
                    plugins: {
                        legend: {
                            position: 'top',
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Max Response Time (ms)'
                            }
                        }
                    }
                }
            });
        }

        function createP95Chart() {
            const ctx = document.getElementById('p95Chart').getContext('2d');
            
            const scenarios = ['mixed_light', 'mixed_medium', 'mixed_heavy', 'mixed_extreme'];
            const implementations = [...new Set(filteredData.map(d => d.implementation))];
            
            const datasets = implementations.map(impl => ({
                label: impl,
                data: scenarios.map(scenario => {
                    const entry = filteredData.find(d => d.implementation === impl && d.test === scenario);
                    return entry && entry.responseTime ? entry.responseTime.p95 : null;
                }),
                borderColor: implementationColors[impl],
                backgroundColor: implementationColors[impl] + '20',
                fill: false,
                tension: 0.1,
                spanGaps: false
            }));

            if (charts.p95) charts.p95.destroy();
            
            charts.p95 = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: scenarios.map(s => s.replace('mixed_', '').toUpperCase()),
                    datasets: datasets
                },
                options: {
                    responsive: true,
                    interaction: {
                        mode: 'index',
                        intersect: false,
                    },
                    plugins: {
                        legend: {
                            position: 'top',
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'P95 Response Time (ms)'
                            }
                        }
                    }
                }
            });
        }

        function createP99Chart() {
            const ctx = document.getElementById('p99Chart').getContext('2d');
            
            const scenarios = ['mixed_light', 'mixed_medium', 'mixed_heavy', 'mixed_extreme'];
            const implementations = [...new Set(filteredData.map(d => d.implementation))];
            
            const datasets = implementations.map(impl => ({
                label: impl,
                data: scenarios.map(scenario => {
                    const entry = filteredData.find(d => d.implementation === impl && d.test === scenario);
                    return entry && entry.responseTime ? entry.responseTime.p99 : null;
                }),
                borderColor: implementationColors[impl],
                backgroundColor: implementationColors[impl] + '20',
                fill: false,
                tension: 0.1,
                spanGaps: false
            }));

            if (charts.p99) charts.p99.destroy();
            
            charts.p99 = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: scenarios.map(s => s.replace('mixed_', '').toUpperCase()),
                    datasets: datasets
                },
                options: {
                    responsive: true,
                    interaction: {
                        mode: 'index',
                        intersect: false,
                    },
                    plugins: {
                        legend: {
                            position: 'top',
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'P99 Response Time (ms)'
                            }
                        }
                    }
                }
            });
        }

        function populateTable() {
            const tbody = document.getElementById('resultsBody');
            tbody.innerHTML = '';
            
            filteredData.forEach(row => {
                const tr = document.createElement('tr');
                
                const implClass = row.implementation.startsWith('rust') ? 'rust' :
                                 row.implementation.startsWith('go') ? 'go' :
                                 row.implementation.startsWith('python') ? 'python' : 'javascript';
                
                tr.innerHTML = `
                    <td><span class="implementation-tag ${implClass}">${row.implementation}</span></td>
                    <td>${row.test.replace('mixed_', '').toUpperCase()}</td>
                    <td>${row.vus}</td>
                    <td>${row.duration}</td>
                    <td class="rps-value">${row.rps ? Math.round(row.rps).toLocaleString() : 'N/A'}</td>
                    <td class="rps-value">${row.responseTime ? Math.round(row.responseTime.avg * 100) / 100 : 'N/A'}</td>
                    <td class="rps-value">${row.responseTime ? Math.round(row.responseTime.p95 * 100) / 100 : 'N/A'}</td>
                    <td class="rps-value">${row.responseTime ? Math.round(row.responseTime.p99 * 100) / 100 : 'N/A'}</td>
                    <td class="status-${row.status}">${row.status.toUpperCase()}</td>
                `;
                
                tbody.appendChild(tr);
            });
        }

        function setupEventListeners() {
            document.getElementById('scenarioFilter').addEventListener('change', filterData);
            document.getElementById('implementationFilter').addEventListener('change', filterData);
            
            // Add sorting event listeners to table headers
            document.querySelectorAll('th.sortable').forEach(header => {
                header.addEventListener('click', () => {
                    const column = header.dataset.column;
                    sortTable(column);
                });
            });
        }

        function sortTable(column) {
            // Toggle sort direction if clicking the same column
            if (currentSort.column === column) {
                currentSort.direction = currentSort.direction === 'asc' ? 'desc' : 'asc';
            } else {
                currentSort.column = column;
                currentSort.direction = 'asc';
            }

            // Update header visual indicators
            document.querySelectorAll('th.sortable').forEach(header => {
                header.classList.remove('sort-asc', 'sort-desc');
                if (header.dataset.column === column) {
                    header.classList.add(currentSort.direction === 'asc' ? 'sort-asc' : 'sort-desc');
                }
            });

            // Sort the data
            filteredData.sort((a, b) => {
                let valueA, valueB;

                switch (column) {
                    case 'implementation':
                        valueA = a.implementation;
                        valueB = b.implementation;
                        break;
                    case 'test':
                        valueA = a.test;
                        valueB = b.test;
                        break;
                    case 'vus':
                        valueA = a.vus;
                        valueB = b.vus;
                        break;
                    case 'duration':
                        valueA = a.duration;
                        valueB = b.duration;
                        break;
                    case 'rps':
                        valueA = a.rps || 0;
                        valueB = b.rps || 0;
                        break;
                    case 'avgRT':
                        valueA = a.responseTime ? a.responseTime.avg : 999999;
                        valueB = b.responseTime ? b.responseTime.avg : 999999;
                        break;
                    case 'p95RT':
                        valueA = a.responseTime ? a.responseTime.p95 : 999999;
                        valueB = b.responseTime ? b.responseTime.p95 : 999999;
                        break;
                    case 'p99RT':
                        valueA = a.responseTime ? a.responseTime.p99 : 999999;
                        valueB = b.responseTime ? b.responseTime.p99 : 999999;
                        break;
                    case 'status':
                        valueA = a.status;
                        valueB = b.status;
                        break;
                    default:
                        return 0;
                }

                // Handle different data types
                if (typeof valueA === 'string' && typeof valueB === 'string') {
                    valueA = valueA.toLowerCase();
                    valueB = valueB.toLowerCase();
                }

                let comparison = 0;
                if (valueA > valueB) {
                    comparison = 1;
                } else if (valueA < valueB) {
                    comparison = -1;
                }

                return currentSort.direction === 'desc' ? comparison * -1 : comparison;
            });

            // Repopulate the table
            populateTable();
        }

        function applySorting() {
            if (!currentSort.column) return;

            const column = currentSort.column;
            
            filteredData.sort((a, b) => {
                let valueA, valueB;

                switch (column) {
                    case 'implementation':
                        valueA = a.implementation;
                        valueB = b.implementation;
                        break;
                    case 'test':
                        valueA = a.test;
                        valueB = b.test;
                        break;
                    case 'vus':
                        valueA = a.vus;
                        valueB = b.vus;
                        break;
                    case 'duration':
                        valueA = a.duration;
                        valueB = b.duration;
                        break;
                    case 'rps':
                        valueA = a.rps || 0;
                        valueB = b.rps || 0;
                        break;
                    case 'avgRT':
                        valueA = a.responseTime ? a.responseTime.avg : 999999;
                        valueB = b.responseTime ? b.responseTime.avg : 999999;
                        break;
                    case 'p95RT':
                        valueA = a.responseTime ? a.responseTime.p95 : 999999;
                        valueB = b.responseTime ? b.responseTime.p95 : 999999;
                        break;
                    case 'p99RT':
                        valueA = a.responseTime ? a.responseTime.p99 : 999999;
                        valueB = b.responseTime ? b.responseTime.p99 : 999999;
                        break;
                    case 'status':
                        valueA = a.status;
                        valueB = b.status;
                        break;
                    default:
                        return 0;
                }

                // Handle different data types
                if (typeof valueA === 'string' && typeof valueB === 'string') {
                    valueA = valueA.toLowerCase();
                    valueB = valueB.toLowerCase();
                }

                let comparison = 0;
                if (valueA > valueB) {
                    comparison = 1;
                } else if (valueA < valueB) {
                    comparison = -1;
                }

                return currentSort.direction === 'desc' ? comparison * -1 : comparison;
            });
        }

        function filterData() {
            const scenarioFilter = document.getElementById('scenarioFilter').value;
            const implementationFilter = document.getElementById('implementationFilter').value;
            
            filteredData = benchmarkData.filter(d => {
                const scenarioMatch = scenarioFilter === 'all' || d.test === scenarioFilter;
                const implMatch = implementationFilter === 'all' || d.implementation === implementationFilter;
                return scenarioMatch && implMatch;
            });
            
            // Reapply current sort if one exists
            if (currentSort.column) {
                // Apply sorting without calling sortTable to avoid recursion
                applySorting();
            }
            
            updateStats();
            createCharts();
            populateTable();
        }

        // Initialize dashboard when page loads
        document.addEventListener('DOMContentLoaded', initDashboard);
    </script>
</body>
</html>
